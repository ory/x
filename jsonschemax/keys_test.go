package jsonschemax

import (
	"bytes"
	"encoding/json"
	"fmt"
	"io/ioutil"
	"testing"

	"github.com/ory/x/assertx"

	"github.com/pkg/errors"

	"github.com/stretchr/testify/require"

	"github.com/ory/jsonschema/v3"
)

const recursiveSchema = `{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "test.json",
  "definitions": {
    "foo": {
      "type": "object",
      "properties": {
		"bars": {
			"type": "string",
			"format": "email",
			"pattern": ".*"
		},
        "bar": {
          "$ref": "#/definitions/bar"
        }
      }
    },
    "bar": {
      "type": "object",
      "properties": {
		"foos": {
		  "type": "string",
		  "minLength": 1,
		  "maxLength": 10
		},
        "foo": {
          "$ref": "#/definitions/foo"
        }
      }
    }
  },
  "type": "object",
  "properties": {
    "bar": {
      "$ref": "#/definitions/bar"
    }
  }
}`

func readFile(t *testing.T, path string) string {
	schema, err := ioutil.ReadFile(path)
	require.NoError(t, err)
	return string(schema)
}

const fooExtensionName = "fooExtension"

type (
	extensionConfig struct {
		NotAJSONSchemaKey string `json:"not-a-json-schema-key"`
	}
)

func fooExtensionCompile(_ jsonschema.CompilerContext, m map[string]interface{}) (interface{}, error) {
	if raw, ok := m[fooExtensionName]; ok {
		var b bytes.Buffer
		if err := json.NewEncoder(&b).Encode(raw); err != nil {
			return nil, errors.WithStack(err)
		}

		var e extensionConfig
		if err := json.NewDecoder(&b).Decode(&e); err != nil {
			return nil, errors.WithStack(err)
		}

		return &e, nil
	}
	return nil, nil
}

func fooExtensionValidate(_ jsonschema.ValidationContext, _, _ interface{}) error {
	return nil
}

func (ec *extensionConfig) EnhancePath(p Path) map[string]interface{} {
	if ec.NotAJSONSchemaKey != "" {
		fmt.Printf("enhancing path: %s with custom property %s\n", p.Name, ec.NotAJSONSchemaKey)
		return map[string]interface{}{
			ec.NotAJSONSchemaKey: p.Name,
		}
	}
	return nil
}

func TestListPathsWithRecursion(t *testing.T) {
	for k, tc := range []struct {
		recursion uint8
		expected  interface{}
	}{
		{
			recursion: 5,
			expected: json.RawMessage(`[
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar.foo",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar.foo.bar",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar.foo.bar.foo",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar.foo.bar.foo.bar",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar.foo.bar.foo.bar.foo",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar.foo.bar.foo.bar.foos",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": 1,
    "MaxLength": 10,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar.foo.bar.foo.bars",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "email",
    "Pattern": {},
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar.foo.bar.foos",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": 1,
    "MaxLength": 10,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar.foo.bars",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "email",
    "Pattern": {},
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar.foos",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": 1,
    "MaxLength": 10,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  }
]`),
		},
	} {
		t.Run(fmt.Sprintf("case=%d", k), func(t *testing.T) {
			c := jsonschema.NewCompiler()
			require.NoError(t, c.AddResource("test.json", bytes.NewBufferString(recursiveSchema)))
			actual, err := ListPathsWithRecursion("test.json", c, tc.recursion)
			require.NoError(t, err)

			assertx.EqualAsJSON(t, tc.expected, actual)
		})
	}
}

func TestListPaths(t *testing.T) {
	for k, tc := range []struct {
		schema    string
		expectErr bool
		expected  interface{}
		extension *jsonschema.Extension
	}{
		{
			schema: readFile(t, "./stub/.oathkeeper.schema.json"),
			expected: json.RawMessage(`[
  {
    "Title": "Access Rules",
    "Description": "Configure access rules. All sub-keys support configuration reloading without restarting.",
    "Examples": null,
    "Name": "access_rules",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Repositories",
    "Description": "Locations (list of URLs) where access rules should be fetched from on boot. It is expected that the documents at those locations return a JSON or YAML Array containing ORY Oathkeeper Access Rules:\n\n- If the URL Scheme is ` + "`" + `file://` + "`" + `, the access rules (an array of access rules is expected) will be fetched from the local file system.\n- If the URL Scheme is ` + "`" + `inline://` + "`" + `, the access rules (an array of access rules is expected) are expected to be a base64 encoded (with padding!) JSON/YAML string (base64_encode(` + "`" + `[{\"id\":\"foo-rule\",\"authenticators\":[....]}]` + "`" + `)).\n- If the URL Scheme is ` + "`" + `http://` + "`" + ` or ` + "`" + `https://` + "`" + `, the access rules (an array of access rules is expected) will be fetched from the provided HTTP(s) location.",
    "Examples": [
      "[\"file://path/to/rules.json\",\"inline://W3siaWQiOiJmb28tcnVsZSIsImF1dGhlbnRpY2F0b3JzIjpbXX1d\",\"https://path-to-my-rules/rules.json\"]"
    ],
    "Name": "access_rules.repositories",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Authenticators",
    "Description": "For more information on authenticators head over to: https://www.ory.sh/docs/oathkeeper/pipeline/authn",
    "Examples": null,
    "Name": "authenticators",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Anonymous",
    "Description": "The [` + "`" + `anonymous` + "`" + ` authenticator](https://www.ory.sh/docs/oathkeeper/pipeline/authn#anonymous).",
    "Examples": null,
    "Name": "authenticators.anonymous",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Anonymous Authenticator Configuration",
    "Description": "This section is optional when the authenticator is disabled.",
    "Examples": null,
    "Name": "authenticators.anonymous.config",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Anonymous Subject",
    "Description": "Sets the anonymous username.",
    "Examples": [
      "guest",
      "anon",
      "anonymous",
      "unknown"
    ],
    "Name": "authenticators.anonymous.config.subject",
    "Default": "anonymous",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "authenticators.anonymous.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Cookie Session",
    "Description": "The [` + "`" + `cookie_session` + "`" + ` authenticator](https://www.ory.sh/docs/oathkeeper/pipeline/authn#cookie_session).",
    "Examples": null,
    "Name": "authenticators.cookie_session",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Cookie Session Authenticator Configuration",
    "Description": "This section is optional when the authenticator is disabled.",
    "Examples": null,
    "Name": "authenticators.cookie_session.config",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Session Check URL",
    "Description": "The origin to proxy requests to. If the response is a 200 with body ` + "`" + `{ \"subject\": \"...\", \"extra\": {} }` + "`" + `. The request will pass the subject through successfully, otherwise it will be marked as unauthorized.\n\n\u003eIf this authenticator is enabled, this value is required.",
    "Examples": [
      "https://session-store-host"
    ],
    "Name": "authenticators.cookie_session.config.check_session_url",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "uri",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Only Cookies",
    "Description": "A list of possible cookies to look for on incoming requests, and will fallthrough to the next authenticator if none of the passed cookies are set on the request.",
    "Examples": null,
    "Name": "authenticators.cookie_session.config.only",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "authenticators.cookie_session.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "JSON Web Token (jwt)",
    "Description": "The [` + "`" + `jwt` + "`" + ` authenticator](https://www.ory.sh/docs/oathkeeper/pipeline/authn#jwt).",
    "Examples": null,
    "Name": "authenticators.jwt",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "JWT Authenticator Configuration",
    "Description": "This section is optional when the authenticator is disabled.",
    "Examples": null,
    "Name": "authenticators.jwt.config",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "authenticators.jwt.config.allowed_algorithms",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "JSON Web Key URLs",
    "Description": "URLs where ORY Oathkeeper can retrieve JSON Web Keys from for validating the JSON Web Token. Usually something like \"https://my-keys.com/.well-known/jwks.json\". The response of that endpoint must return a JSON Web Key Set (JWKS).\n\n\u003eIf this authenticator is enabled, this value is required.",
    "Examples": [
      "https://my-website.com/.well-known/jwks.json",
      "https://my-other-website.com/.well-known/jwks.json",
      "file://path/to/local/jwks.json"
    ],
    "Name": "authenticators.jwt.config.jwks_urls",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Required Token Scope",
    "Description": "An array of OAuth 2.0 scopes that are required when accessing an endpoint protected by this handler.\n If the token used in the Authorization header did not request that specific scope, the request is denied.",
    "Examples": null,
    "Name": "authenticators.jwt.config.required_scope",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Scope Strategy",
    "Description": "Sets the strategy validation algorithm.",
    "Examples": null,
    "Name": "authenticators.jwt.config.scope_strategy",
    "Default": "none",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": [
      "hierarchic",
      "exact",
      "wildcard",
      "none"
    ],
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Intended Audience",
    "Description": "An array of audiences that are required when accessing an endpoint protected by this handler.\n If the token used in the Authorization header is not intended for any of the requested audiences, the request is denied.",
    "Examples": null,
    "Name": "authenticators.jwt.config.target_audience",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "authenticators.jwt.config.token_from",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Header",
    "Description": "The header (case insensitive) that must contain a token for request authentication. It can't be set along with query_parameter.",
    "Examples": null,
    "Name": "authenticators.jwt.config.token_from.header",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Query Parameter",
    "Description": "The query parameter (case sensitive) that must contain a token for request authentication. It can't be set along with header.",
    "Examples": null,
    "Name": "authenticators.jwt.config.token_from.query_parameter",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "authenticators.jwt.config.trusted_issuers",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "authenticators.jwt.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "No Operation (noop)",
    "Description": "The [` + "`" + `noop` + "`" + ` authenticator](https://www.ory.sh/docs/oathkeeper/pipeline/authn#noop).",
    "Examples": null,
    "Name": "authenticators.noop",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "authenticators.noop.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "OAuth 2.0 Client Credentials",
    "Description": "The [` + "`" + `oauth2_client_credentials` + "`" + ` authenticator](https://www.ory.sh/docs/oathkeeper/pipeline/authn#oauth2_client_credentials).",
    "Examples": null,
    "Name": "authenticators.oauth2_client_credentials",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "OAuth 2.0 Client Credentials Authenticator Configuration",
    "Description": "This section is optional when the authenticator is disabled.",
    "Examples": null,
    "Name": "authenticators.oauth2_client_credentials.config",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Request Permissions (Token Scope)",
    "Description": "Scopes is an array of OAuth 2.0 scopes that are required when accessing an endpoint protected by this rule.\n If the token used in the Authorization header did not request that specific scope, the request is denied.",
    "Examples": null,
    "Name": "authenticators.oauth2_client_credentials.config.required_scope",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "The OAuth 2.0 Token Endpoint that will be used to validate the client credentials.\n\n\u003eIf this authenticator is enabled, this value is required.",
    "Examples": [
      "https://my-website.com/oauth2/token"
    ],
    "Name": "authenticators.oauth2_client_credentials.config.token_url",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "uri",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "authenticators.oauth2_client_credentials.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "OAuth 2.0 Token Introspection",
    "Description": "The [` + "`" + `oauth2_introspection` + "`" + ` authenticator](https://www.ory.sh/docs/oathkeeper/pipeline/authn#oauth2_introspection).",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "OAuth 2.0 Introspection Authenticator Configuration",
    "Description": "This section is optional when the authenticator is disabled.",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "OAuth 2.0 Introspection URL",
    "Description": "The OAuth 2.0 Token Introspection endpoint URL.\n\n\u003eIf this authenticator is enabled, this value is required.",
    "Examples": [
      "https://my-website.com/oauth2/introspection"
    ],
    "Name": "authenticators.oauth2_introspection.config.introspection_url",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "uri",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Pre-Authorization",
    "Description": "Enable pre-authorization in cases where the OAuth 2.0 Token Introspection endpoint is protected by OAuth 2.0 Bearer Tokens that can be retrieved using the OAuth 2.0 Client Credentials grant.",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config.pre_authorization",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "OAuth 2.0 Client ID",
    "Description": "The OAuth 2.0 Client ID to be used for the OAuth 2.0 Client Credentials Grant.\n\n\u003eIf pre-authorization is enabled, this value is required.",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config.pre_authorization.client_id",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "OAuth 2.0 Client Secret",
    "Description": "The OAuth 2.0 Client Secret to be used for the OAuth 2.0 Client Credentials Grant.\n\n\u003eIf pre-authorization is enabled, this value is required.",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config.pre_authorization.client_secret",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config.pre_authorization.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "OAuth 2.0 Scope",
    "Description": "The OAuth 2.0 Scope to be requested during the OAuth 2.0 Client Credentials Grant.",
    "Examples": [
      [
        "[\"foo\", \"bar\"]"
      ]
    ],
    "Name": "authenticators.oauth2_introspection.config.pre_authorization.scope",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "OAuth 2.0 Token URL",
    "Description": "The OAuth 2.0 Token Endpoint where the OAuth 2.0 Client Credentials Grant will be performed.\n\n\u003eIf pre-authorization is enabled, this value is required.",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config.pre_authorization.token_url",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "uri",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Required Scope",
    "Description": "An array of OAuth 2.0 scopes that are required when accessing an endpoint protected by this handler.\n If the token used in the Authorization header did not request that specific scope, the request is denied.",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config.required_scope",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Scope Strategy",
    "Description": "Sets the strategy validation algorithm.",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config.scope_strategy",
    "Default": "none",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": [
      "hierarchic",
      "exact",
      "wildcard",
      "none"
    ],
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Target Audience",
    "Description": "An array of audiences that are required when accessing an endpoint protected by this handler.\n If the token used in the Authorization header is not intended for any of the requested audiences, the request is denied.",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config.target_audience",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Token From",
    "Description": "The location of the token.\n If not configured, the token will be received from a default location - 'Authorization' header.\n One and only one location (header or query) must be specified.",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config.token_from",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Header",
    "Description": "The header (case insensitive) that must contain a token for request authentication.\n It can't be set along with query_parameter.",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config.token_from.header",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Query Parameter",
    "Description": "The query parameter (case sensitive) that must contain a token for request authentication.\n It can't be set along with header.",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config.token_from.query_parameter",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Trusted Issuers",
    "Description": "The token must have been issued by one of the issuers listed in this array.",
    "Examples": null,
    "Name": "authenticators.oauth2_introspection.config.trusted_issuers",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "authenticators.oauth2_introspection.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Unauthorized",
    "Description": "The [` + "`" + `unauthorized` + "`" + ` authenticator](https://www.ory.sh/docs/oathkeeper/pipeline/authn#unauthorized).",
    "Examples": null,
    "Name": "authenticators.unauthorized",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "authenticators.unauthorized.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Authorizers",
    "Description": "For more information on authorizers head over to: https://www.ory.sh/docs/oathkeeper/pipeline/authz",
    "Examples": null,
    "Name": "authorizers",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Allow",
    "Description": "The [` + "`" + `allow` + "`" + ` authorizer](https://www.ory.sh/docs/oathkeeper/pipeline/authz#allow).",
    "Examples": null,
    "Name": "authorizers.allow",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "authorizers.allow.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Deny",
    "Description": "The [` + "`" + `deny` + "`" + ` authorizer](https://www.ory.sh/docs/oathkeeper/pipeline/authz#allow).",
    "Examples": null,
    "Name": "authorizers.deny",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "authorizers.deny.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "ORY Keto Access Control Policies Engine",
    "Description": "The [` + "`" + `keto_engine_acp_ory` + "`" + ` authorizer](https://www.ory.sh/docs/oathkeeper/pipeline/authz#keto_engine_acp_ory).",
    "Examples": null,
    "Name": "authorizers.keto_engine_acp_ory",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "ORY Keto Access Control Policy Authorizer Configuration",
    "Description": "This section is optional when the authorizer is disabled.",
    "Examples": null,
    "Name": "authorizers.keto_engine_acp_ory.config",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Base URL",
    "Description": "The base URL of ORY Keto.\n\n\u003eIf this authorizer is enabled, this value is required.",
    "Examples": [
      "http://my-keto/"
    ],
    "Name": "authorizers.keto_engine_acp_ory.config.base_url",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "uri",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "authorizers.keto_engine_acp_ory.config.flavor",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "authorizers.keto_engine_acp_ory.config.required_action",
    "Default": "unset",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "authorizers.keto_engine_acp_ory.config.required_resource",
    "Default": "unset",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "authorizers.keto_engine_acp_ory.config.subject",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "authorizers.keto_engine_acp_ory.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Log",
    "Description": "Configure logging using the following options. Logging will always be sent to stdout and stderr.",
    "Examples": null,
    "Name": "log",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Format",
    "Description": "The log format can either be text or JSON.",
    "Examples": null,
    "Name": "log.format",
    "Default": "text",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": [
      "text",
      "json"
    ],
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Level",
    "Description": "Debug enables stack traces on errors. Can also be set using environment variable LOG_LEVEL.",
    "Examples": null,
    "Name": "log.level",
    "Default": "info",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": [
      "panic",
      "fatal",
      "error",
      "warn",
      "info",
      "debug"
    ],
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Mutators",
    "Description": "For more information on mutators head over to: https://www.ory.sh/docs/oathkeeper/pipeline/mutator",
    "Examples": null,
    "Name": "mutators",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "HTTP Cookie",
    "Description": "The [` + "`" + `cookie` + "`" + ` mutator](https://www.ory.sh/docs/oathkeeper/pipeline/mutator#cookie).",
    "Examples": null,
    "Name": "mutators.cookie",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Cookie Mutator Configuration",
    "Description": "This section is optional when the mutator is disabled.",
    "Examples": null,
    "Name": "mutators.cookie.config",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "mutators.cookie.config.cookies",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "mutators.cookie.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "HTTP Header",
    "Description": "The [` + "`" + `header` + "`" + ` mutator](https://www.ory.sh/docs/oathkeeper/pipeline/mutator#header).",
    "Examples": null,
    "Name": "mutators.header",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Header Mutator Configuration",
    "Description": "This section is optional when the mutator is disabled.",
    "Examples": null,
    "Name": "mutators.header.config",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "mutators.header.config.headers",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "mutators.header.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Hydrator",
    "Description": "The [` + "`" + `hydrator` + "`" + ` mutator](https://www.ory.sh/docs/oathkeeper/pipeline/mutator#hydrator).",
    "Examples": null,
    "Name": "mutators.hydrator",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Hydrator Mutator Configuration",
    "Description": "This section is optional when the mutator is disabled.",
    "Examples": null,
    "Name": "mutators.hydrator.config",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "mutators.hydrator.config.api",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "mutators.hydrator.config.api.auth",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "mutators.hydrator.config.api.auth.basic",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "mutators.hydrator.config.api.auth.basic.password",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "mutators.hydrator.config.api.auth.basic.username",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "mutators.hydrator.config.api.retry",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "mutators.hydrator.config.api.retry.delay_in_milliseconds",
    "Default": 3,
    "Type": 0,
    "TypeHint": 3,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": "0",
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "mutators.hydrator.config.api.retry.number_of_retries",
    "Default": 100,
    "Type": 0,
    "TypeHint": 2,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": "0",
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "mutators.hydrator.config.api.url",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "uri",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "mutators.hydrator.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "ID Token (JSON Web Token)",
    "Description": "The [` + "`" + `id_token` + "`" + ` mutator](https://www.ory.sh/docs/oathkeeper/pipeline/mutator#id_token).",
    "Examples": null,
    "Name": "mutators.id_token",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "ID Token Mutator Configuration",
    "Description": "This section is optional when the mutator is disabled.",
    "Examples": null,
    "Name": "mutators.id_token.config",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "mutators.id_token.config.claims",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Issuer URL",
    "Description": "Sets the \"iss\" value of the ID Token.\n\n\u003eIf this mutator is enabled, this value is required.",
    "Examples": null,
    "Name": "mutators.id_token.config.issuer_url",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "JSON Web Key URL",
    "Description": "Sets the URL where keys should be fetched from. Supports remote locations (http, https) as well as local filesystem paths.\n\n\u003eIf this mutator is enabled, this value is required.",
    "Examples": [
      "https://fetch-keys/from/this/location.json",
      "file:///from/this/absolute/location.json",
      "file://../from/this/relative/location.json"
    ],
    "Name": "mutators.id_token.config.jwks_url",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "uri",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Expire After",
    "Description": "Sets the time-to-live of the JSON Web Token.",
    "Examples": [
      "1h",
      "1m",
      "30s"
    ],
    "Name": "mutators.id_token.config.ttl",
    "Default": "1m",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": {},
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "mutators.id_token.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "No Operation (noop)",
    "Description": "The [` + "`" + `noop` + "`" + ` mutator](https://www.ory.sh/docs/oathkeeper/pipeline/mutator#noop).",
    "Examples": null,
    "Name": "mutators.noop",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enabled",
    "Description": "En-/disables this component.",
    "Examples": [
      true
    ],
    "Name": "mutators.noop.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Profiling",
    "Description": "Enables CPU or memory profiling if set. For more details on profiling Go programs read [Profiling Go Programs](https://blog.golang.org/profiling-go-programs).",
    "Examples": null,
    "Name": "profiling",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": [
      "cpu",
      "mem"
    ],
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "HTTP(s)",
    "Description": "",
    "Examples": null,
    "Name": "serve",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "HTTP REST API",
    "Description": "",
    "Examples": null,
    "Name": "serve.api",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Cross Origin Resource Sharing (CORS)",
    "Description": "Configure [Cross Origin Resource Sharing (CORS)](http://www.w3.org/TR/cors/) using the following options.",
    "Examples": null,
    "Name": "serve.api.cors",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Allow HTTP Credentials",
    "Description": "Indicates whether the request can include user credentials like cookies, HTTP authentication or client side SSL certificates.",
    "Examples": null,
    "Name": "serve.api.cors.allow_credentials",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Allowed Request HTTP Headers",
    "Description": "A list of non simple headers the client is allowed to use with cross-domain requests.",
    "Examples": null,
    "Name": "serve.api.cors.allowed_headers",
    "Default": [
      "Authorization",
      "Content-Type"
    ],
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": 1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Allowed HTTP Methods",
    "Description": "A list of methods the client is allowed to use with cross-domain requests.",
    "Examples": null,
    "Name": "serve.api.cors.allowed_methods",
    "Default": [
      "GET",
      "POST",
      "PUT",
      "PATCH",
      "DELETE"
    ],
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Allowed Origins",
    "Description": "A list of origins a cross-domain request can be executed from. If the special * value is present in the list, all origins will be allowed. An origin may contain a wildcard (*) to replace 0 or more characters (i.e.: http://*.domain.com). Usage of wildcards implies a small performance penality. Only one wildcard can be used per origin.",
    "Examples": [
      "https://example.com",
      "https://*.example.com",
      "https://*.foo.example.com"
    ],
    "Name": "serve.api.cors.allowed_origins",
    "Default": [
      "*"
    ],
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enable Debugging",
    "Description": "Set to true to debug server side CORS issues.",
    "Examples": null,
    "Name": "serve.api.cors.debug",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enable CORS",
    "Description": "If set to true, CORS will be enabled and preflight-requests (OPTION) will be answered.",
    "Examples": null,
    "Name": "serve.api.cors.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Allowed Response HTTP Headers",
    "Description": "Indicates which headers are safe to expose to the API of a CORS API specification",
    "Examples": null,
    "Name": "serve.api.cors.exposed_headers",
    "Default": [
      "Content-Type"
    ],
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": 1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Maximum Age",
    "Description": "Indicates how long (in seconds) the results of a preflight request can be cached. The default is 0 which stands for no max age.",
    "Examples": null,
    "Name": "serve.api.cors.max_age",
    "Default": 0,
    "Type": 0,
    "TypeHint": 2,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Host",
    "Description": "The network interface to listen on.",
    "Examples": [
      "localhost",
      "127.0.0.1"
    ],
    "Name": "serve.api.host",
    "Default": "",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Port",
    "Description": "The port to listen on.",
    "Examples": null,
    "Name": "serve.api.port",
    "Default": 4456,
    "Type": 0,
    "TypeHint": 2,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "HTTPS",
    "Description": "Configure HTTP over TLS (HTTPS). All options can also be set using environment variables by replacing dots (` + "`" + `.` + "`" + `) with underscores (` + "`" + `_` + "`" + `) and uppercasing the key. For example, ` + "`" + `some.prefix.tls.key.path` + "`" + ` becomes ` + "`" + `export SOME_PREFIX_TLS_KEY_PATH` + "`" + `. If all keys are left undefined, TLS will be disabled.",
    "Examples": null,
    "Name": "serve.api.tls",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "serve.api.tls.cert",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Base64 Encoded Inline",
    "Description": "The base64 string of the PEM-encoded file content. Can be generated using for example ` + "`" + `base64 -i path/to/file.pem` + "`" + `.",
    "Examples": [
      "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tXG5NSUlEWlRDQ0FrMmdBd0lCQWdJRVY1eE90REFOQmdr..."
    ],
    "Name": "serve.api.tls.cert.base64",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Path to PEM-encoded Fle",
    "Description": "",
    "Examples": [
      "path/to/file.pem"
    ],
    "Name": "serve.api.tls.cert.path",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "serve.api.tls.key",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Base64 Encoded Inline",
    "Description": "The base64 string of the PEM-encoded file content. Can be generated using for example ` + "`" + `base64 -i path/to/file.pem` + "`" + `.",
    "Examples": [
      "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tXG5NSUlEWlRDQ0FrMmdBd0lCQWdJRVY1eE90REFOQmdr..."
    ],
    "Name": "serve.api.tls.key.base64",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Path to PEM-encoded Fle",
    "Description": "",
    "Examples": [
      "path/to/file.pem"
    ],
    "Name": "serve.api.tls.key.path",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "HTTP Reverse Proxy",
    "Description": "",
    "Examples": null,
    "Name": "serve.proxy",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Cross Origin Resource Sharing (CORS)",
    "Description": "Configure [Cross Origin Resource Sharing (CORS)](http://www.w3.org/TR/cors/) using the following options.",
    "Examples": null,
    "Name": "serve.proxy.cors",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Allow HTTP Credentials",
    "Description": "Indicates whether the request can include user credentials like cookies, HTTP authentication or client side SSL certificates.",
    "Examples": null,
    "Name": "serve.proxy.cors.allow_credentials",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Allowed Request HTTP Headers",
    "Description": "A list of non simple headers the client is allowed to use with cross-domain requests.",
    "Examples": null,
    "Name": "serve.proxy.cors.allowed_headers",
    "Default": [
      "Authorization",
      "Content-Type"
    ],
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": 1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Allowed HTTP Methods",
    "Description": "A list of methods the client is allowed to use with cross-domain requests.",
    "Examples": null,
    "Name": "serve.proxy.cors.allowed_methods",
    "Default": [
      "GET",
      "POST",
      "PUT",
      "PATCH",
      "DELETE"
    ],
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Allowed Origins",
    "Description": "A list of origins a cross-domain request can be executed from. If the special * value is present in the list, all origins will be allowed. An origin may contain a wildcard (*) to replace 0 or more characters (i.e.: http://*.domain.com). Usage of wildcards implies a small performance penality. Only one wildcard can be used per origin.",
    "Examples": [
      "https://example.com",
      "https://*.example.com",
      "https://*.foo.example.com"
    ],
    "Name": "serve.proxy.cors.allowed_origins",
    "Default": [
      "*"
    ],
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enable Debugging",
    "Description": "Set to true to debug server side CORS issues.",
    "Examples": null,
    "Name": "serve.proxy.cors.debug",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Enable CORS",
    "Description": "If set to true, CORS will be enabled and preflight-requests (OPTION) will be answered.",
    "Examples": null,
    "Name": "serve.proxy.cors.enabled",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Allowed Response HTTP Headers",
    "Description": "Indicates which headers are safe to expose to the API of a CORS API specification",
    "Examples": null,
    "Name": "serve.proxy.cors.exposed_headers",
    "Default": [
      "Content-Type"
    ],
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": 1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Maximum Age",
    "Description": "Indicates how long (in seconds) the results of a preflight request can be cached. The default is 0 which stands for no max age.",
    "Examples": null,
    "Name": "serve.proxy.cors.max_age",
    "Default": 0,
    "Type": 0,
    "TypeHint": 2,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Host",
    "Description": "The network interface to listen on. Leave empty to listen on all interfaces.",
    "Examples": [
      "localhost",
      "127.0.0.1"
    ],
    "Name": "serve.proxy.host",
    "Default": "",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Port",
    "Description": "The port to listen on.",
    "Examples": null,
    "Name": "serve.proxy.port",
    "Default": 4455,
    "Type": 0,
    "TypeHint": 2,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "HTTP Timeouts",
    "Description": "Control the reverse proxy's HTTP timeouts.",
    "Examples": null,
    "Name": "serve.proxy.timeout",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "HTTP Idle Timeout",
    "Description": " The maximum amount of time to wait for any action of a request session, reading data or writing the response.",
    "Examples": [
      "5s",
      "5m",
      "5h"
    ],
    "Name": "serve.proxy.timeout.idle",
    "Default": "120s",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": {},
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "HTTP Read Timeout",
    "Description": "The maximum duration for reading the entire request, including the body.",
    "Examples": [
      "5s",
      "5m",
      "5h"
    ],
    "Name": "serve.proxy.timeout.read",
    "Default": "5s",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": {},
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "HTTP Write Timeout",
    "Description": "The maximum duration before timing out writes of the response. Increase this parameter to prevent unexpected closing a client connection if an upstream request is responding slowly.",
    "Examples": [
      "5s",
      "5m",
      "5h"
    ],
    "Name": "serve.proxy.timeout.write",
    "Default": "120s",
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": {},
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "HTTPS",
    "Description": "Configure HTTP over TLS (HTTPS). All options can also be set using environment variables by replacing dots (` + "`" + `.` + "`" + `) with underscores (` + "`" + `_` + "`" + `) and uppercasing the key. For example, ` + "`" + `some.prefix.tls.key.path` + "`" + ` becomes ` + "`" + `export SOME_PREFIX_TLS_KEY_PATH` + "`" + `. If all keys are left undefined, TLS will be disabled.",
    "Examples": null,
    "Name": "serve.proxy.tls",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "serve.proxy.tls.cert",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Base64 Encoded Inline",
    "Description": "The base64 string of the PEM-encoded file content. Can be generated using for example ` + "`" + `base64 -i path/to/file.pem` + "`" + `.",
    "Examples": [
      "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tXG5NSUlEWlRDQ0FrMmdBd0lCQWdJRVY1eE90REFOQmdr..."
    ],
    "Name": "serve.proxy.tls.cert.base64",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Path to PEM-encoded Fle",
    "Description": "",
    "Examples": [
      "path/to/file.pem"
    ],
    "Name": "serve.proxy.tls.cert.path",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "serve.proxy.tls.key",
    "Default": null,
    "Type": {},
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Base64 Encoded Inline",
    "Description": "The base64 string of the PEM-encoded file content. Can be generated using for example ` + "`" + `base64 -i path/to/file.pem` + "`" + `.",
    "Examples": [
      "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tXG5NSUlEWlRDQ0FrMmdBd0lCQWdJRVY1eE90REFOQmdr..."
    ],
    "Name": "serve.proxy.tls.key.base64",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "Path to PEM-encoded Fle",
    "Description": "",
    "Examples": [
      "path/to/file.pem"
    ],
    "Name": "serve.proxy.tls.key.path",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  }
]`),
		},
		{
			schema: readFile(t, "./stub/config.schema.json"),
			expected: json.RawMessage(`[
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "dsn",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  }
]`),
		},
		{
			// this should fail because of recursion
			schema:    recursiveSchema,
			expectErr: true,
		},
		{
			schema: `{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "test.json",
  "oneOf": [
    {
      "type": "object",
      "properties": {
        "list": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "foo": {
          "default": false,
          "type": "boolean"
        },
        "bar": {
          "type": "boolean",
          "default": "asdf",
          "readOnly": true
        }
      }
    },
    {
      "type": "object",
      "properties": {
        "foo": {
          "type": "boolean"
        }
      }
    }
  ]
}`,
			expected: json.RawMessage(`[
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar",
    "Default": "asdf",
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": true,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "foo",
    "Default": false,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "list",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  }
]`),
		},
		{
			schema: `{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "test.json",
  "type": "object",
  "properties": {
    "foo": {
      "type": "boolean"
    },
    "bar": {
      "type": "string",
      "fooExtension": {
        "not-a-json-schema-key": "foobar"
      }
    }
  }
}`,
			extension: &jsonschema.Extension{
				Meta:     nil,
				Compile:  fooExtensionCompile,
				Validate: fooExtensionValidate,
			},
			expected: json.RawMessage(`[
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar",
    "Default": null,
    "Type": "",
    "TypeHint": 1,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": {
      "foobar": "bar"
    }
  },
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "foo",
    "Default": null,
    "Type": false,
    "TypeHint": 4,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  }
]`),
		},
		{
			schema: `{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "test.json",
  "type": "object",
  "definitions": {
    "foo": {
      "type": "string"
    }
  },
  "properties": {
    "bar": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/foo"
      }
    }
  }
}`,
			expected: json.RawMessage(`[
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "bar",
    "Default": null,
    "Type": [],
    "TypeHint": 8,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  }
]`),
		},
		{
			schema: `{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "test.json",
  "type": "object",
  "definitions": {
    "foo": {
      "type": "string"
    },
    "bar": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/foo"
      }
    }
  },
  "properties": {
    "baz": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/bar"
      }
    }
  }
}`,
			expected: json.RawMessage(`[
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "baz",
    "Default": null,
    "Type": [],
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  }
]`),
		},
		{
			schema: `{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "test.json",
  "type": "object",
  "definitions": {
    "foo": {
      "type": "string"
    },
    "bar": {
      "type": "object",
      "properties": {
        "foo": {
          "$ref": "#/definitions/foo"
        }
      }
    }
  },
  "properties": {
    "baz": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/bar"
      }
    }
  }
}`,
			expected: json.RawMessage(`[
  {
    "Title": "",
    "Description": "",
    "Examples": null,
    "Name": "baz",
    "Default": null,
    "Type": [],
    "TypeHint": 5,
    "Format": "",
    "Pattern": null,
    "Enum": null,
    "Constant": null,
    "ReadOnly": false,
    "MinLength": -1,
    "MaxLength": -1,
    "Minimum": null,
    "Maximum": null,
    "MultipleOf": null,
    "CustomProperties": null
  }
]`),
		},
	} {
		t.Run(fmt.Sprintf("case=%d", k), func(t *testing.T) {
			c := jsonschema.NewCompiler()
			if tc.extension != nil {
				c.Extensions[fooExtensionName] = *tc.extension
			}

			require.NoError(t, c.AddResource("test.json", bytes.NewBufferString(tc.schema)))
			actual, err := ListPaths("test.json", c)
			if tc.expectErr {
				require.Error(t, err, "%+v", actual)
				return
			}
			require.NoError(t, err)
			//t.Logf("%#v", actual)

			assertx.EqualAsJSON(t, tc.expected, actual)
			//assertEqualPaths(t, tc.expected, actual)
		})
	}
}
